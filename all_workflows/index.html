
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://prefecthq.github.io/prefect-openmetadata/all_workflows/">
      
      
        <link rel="prev" href="../run_ingestion_flow/">
      
      
        <link rel="next" href="../schedule_ingestion_flow/">
      
      <link rel="icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.16">
    
    
      
        <title>Metadata worfklows with Snowflake - prefect-openmetadata</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.26e3688c.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ecc896b0.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CSource+Code+Pro:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"Source Code Pro"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#run-metadata-ingestion-usage-workflow-and-data-profiler-for-snowflake" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="prefect-openmetadata" class="md-header__button md-logo" aria-label="prefect-openmetadata" data-md-component="logo">
      
  <img src="../img/prefect-logo-white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            prefect-openmetadata
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Metadata worfklows with Snowflake
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/prefecthq/prefect-openmetadata" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="prefect-openmetadata" class="md-nav__button md-logo" aria-label="prefect-openmetadata" data-md-component="logo">
      
  <img src="../img/prefect-logo-white.png" alt="logo">

    </a>
    prefect-openmetadata
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/prefecthq/prefect-openmetadata" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../install_openmetadata/" class="md-nav__link">
        Install OpenMetadata
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../run_ingestion_flow/" class="md-nav__link">
        Run ingestion flow
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Metadata worfklows with Snowflake
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Metadata worfklows with Snowflake
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configure-your-profiling-spec" class="md-nav__link">
    Configure your profiling spec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-ingestion-and-profiling-for-snowflake" class="md-nav__link">
    Sample ingestion and profiling for Snowflake
  </a>
  
    <nav class="md-nav" aria-label="Sample ingestion and profiling for Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-sqlalchemy-package-for-your-connector" class="md-nav__link">
    Install SQLAlchemy package for your connector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-connection" class="md-nav__link">
    Test the connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingest-your-metadata" class="md-nav__link">
    Ingest your metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-your-data-and-add-data-quality-tests" class="md-nav__link">
    Profile your data and add data quality tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-usage-query-patterns" class="md-nav__link">
    Add usage query patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../schedule_ingestion_flow/" class="md-nav__link">
        Schedule ingestion flow
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../flows/" class="md-nav__link">
        Flows & tasks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ingestion_workflow/" class="md-nav__link">
        Ingestion workflow module
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../profiler_workflow/" class="md-nav__link">
        Profiler workflow module
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configure-your-profiling-spec" class="md-nav__link">
    Configure your profiling spec
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sample-ingestion-and-profiling-for-snowflake" class="md-nav__link">
    Sample ingestion and profiling for Snowflake
  </a>
  
    <nav class="md-nav" aria-label="Sample ingestion and profiling for Snowflake">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#install-sqlalchemy-package-for-your-connector" class="md-nav__link">
    Install SQLAlchemy package for your connector
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-the-connection" class="md-nav__link">
    Test the connection
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingest-your-metadata" class="md-nav__link">
    Ingest your metadata
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#profile-your-data-and-add-data-quality-tests" class="md-nav__link">
    Profile your data and add data quality tests
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-usage-query-patterns" class="md-nav__link">
    Add usage query patterns
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="run-metadata-ingestion-usage-workflow-and-data-profiler-for-snowflake">Run metadata ingestion, usage workflow and data profiler for Snowflake</h1>
<p>This demo will walk you through the process of creating ingestion, usage and profiling workflows.</p>
<h2 id="configure-your-profiling-spec">Configure your profiling spec</h2>
<p>OpenMetadata heavily relies on schemas. You need to understand which arguments are required and which are optional, and which are important for your use case. The easiest way to identify the required and optional arguments of any ingestion or profiling workflow is to import the <code>OpenMetadataWorkflowConfig</code>. </p>
<p>From this pydantic model, you can drill down into other components using your favorite IDE e.g. Pycharm or VSCode. From there, you can again drill down into <code>Source</code>, <code>SourceConfig</code>, <code>Sink</code>, etc.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">metadata.generated.schema.metadataIngestion.workflow</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">OpenMetadataWorkflowConfig</span><span class="p">,</span> <span class="n">Source</span><span class="p">,</span> <span class="n">SourceConfig</span><span class="p">,</span> <span class="n">Sink</span>
<span class="p">)</span>
</code></pre></div>
<h2 id="sample-ingestion-and-profiling-for-snowflake">Sample ingestion and profiling for Snowflake</h2>
<p>Let's demonstrate how you can profile your data and add data quality tests for a Snowflake data warehouse using Prefect. </p>
<h3 id="install-sqlalchemy-package-for-your-connector">Install SQLAlchemy package for your connector</h3>
<p>First, make sure that you have the <code>prefect-openmetadata</code> and the <code>snowflake-sqlalchemy</code> packages installed in your environment.  </p>
<h3 id="test-the-connection">Test the connection</h3>
<p>You can test the connection to your end destination using the following Prefect flow:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_openmetadata.flows</span> <span class="kn">import</span> <span class="n">validate_connection</span>

<span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">connection:</span>
<span class="s2">  config:</span>
<span class="s2">    type: Snowflake</span>
<span class="s2">    username: DEMO</span>
<span class="s2">    password: xxx</span>
<span class="s2">    account: xxx.us-east-2.aws</span>
<span class="s2">    database: YOUR_DB</span>
<span class="s2">    warehouse: COMPUTE_WH</span>
<span class="s2">connectionType: Database</span>
<span class="s2">&quot;&quot;&quot;</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">validate_connection</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<h3 id="ingest-your-metadata">Ingest your metadata</h3>
<p>You can use the configuration below as a template - make sure to adjust it to match your username, password, your database name, and further details about the tables and schemas you want to include. You may optionally ingest your dbt manifest and dbt catalog to display dbt models and dbt docs along with your tables and views.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_openmetadata.flows</span> <span class="kn">import</span> <span class="n">ingest_metadata</span>

<span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">source:</span>
<span class="s2">  type: snowflake</span>
<span class="s2">  serviceName: snowflake</span>
<span class="s2">  serviceConnection:</span>
<span class="s2">    config:</span>
<span class="s2">      type: Snowflake</span>
<span class="s2">      username: &quot;xxx&quot;</span>
<span class="s2">      password: &quot;xxx&quot;</span>
<span class="s2">      database: &quot;YOURDB&quot;</span>
<span class="s2">      warehouse: &quot;COMPUTE_WH&quot;</span>
<span class="s2">      account: &quot;YOUR_ACCOUNT.us-east-2.aws&quot;</span>
<span class="s2">  sourceConfig:</span>
<span class="s2">    config:</span>
<span class="s2">      type: DatabaseMetadata</span>
<span class="s2">      schemaFilterPattern:</span>
<span class="s2">        includes: </span>
<span class="s2">            - YOUR_SCHEMA</span>
<span class="s2">      dbtConfigSource:</span>
<span class="s2">        dbtCatalogFilePath: /Users/you/catalog.json</span>
<span class="s2">        dbtManifestFilePath: /Users/you/manifest.json</span>
<span class="s2">sink:</span>
<span class="s2">  type: metadata-rest</span>
<span class="s2">  config: </span><span class="si">{}</span>
<span class="s2">workflowConfig:</span>
<span class="s2">  loggerLevel: DEBUG</span>
<span class="s2">  openMetadataServerConfig:</span>
<span class="s2">    hostPort: http://localhost:8585/api</span>
<span class="s2">    authProvider: no-auth</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ingest_metadata</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<h3 id="profile-your-data-and-add-data-quality-tests">Profile your data and add data quality tests</h3>
<p>Here is a flow to profile the previously ingested data:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_openmetadata.flows</span> <span class="kn">import</span> <span class="n">profile_metadata</span>

<span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">source:</span>
<span class="s2">  type: snowflake</span>
<span class="s2">  serviceName: snowflake</span>
<span class="s2">  serviceConnection:</span>
<span class="s2">    config:</span>
<span class="s2">      type: Snowflake</span>
<span class="s2">      username: &quot;xxx&quot;</span>
<span class="s2">      password: &quot;xxx&quot;</span>
<span class="s2">      database: &quot;YOURDB&quot;</span>
<span class="s2">      warehouse: &quot;COMPUTE_WH&quot;</span>
<span class="s2">      account: &quot;YOUR_ACCOUNT.us-east-2.aws&quot;</span>
<span class="s2">  sourceConfig:</span>
<span class="s2">    config:</span>
<span class="s2">      type: Profiler</span>
<span class="s2">      fqnFilterPattern:</span>
<span class="s2">        includes:</span>
<span class="s2">        - snowflake.ANNA.ANNA_DEMO.*</span>
<span class="s2">      generateSampleData: true</span>
<span class="s2">processor:</span>
<span class="s2">  type: orm-profiler</span>
<span class="s2">  config:</span>
<span class="s2">    test_suite:</span>
<span class="s2">      name: demo_data</span>
<span class="s2">      tests:</span>
<span class="s2">        - table: snowflake.ANNA.ANNA_DEMO.RAW_CUSTOMERS</span>
<span class="s2">          table_tests:</span>
<span class="s2">            - testCase:</span>
<span class="s2">                config:</span>
<span class="s2">                  value: 100</span>
<span class="s2">                tableTestType: tableRowCountToEqual</span>
<span class="s2">          column_tests:</span>
<span class="s2">            - columnName: ID</span>
<span class="s2">              testCase:</span>
<span class="s2">                config:</span>
<span class="s2">                  minValue: 1</span>
<span class="s2">                  maxValue: 100</span>
<span class="s2">                columnTestType: columnValuesToBeBetween</span>
<span class="s2">sink:</span>
<span class="s2">  type: metadata-rest</span>
<span class="s2">  config: </span><span class="si">{}</span>
<span class="s2">workflowConfig:</span>
<span class="s2">  openMetadataServerConfig:</span>
<span class="s2">    hostPort: http://localhost:8585/api</span>
<span class="s2">    authProvider: no-auth</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">profile_metadata</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<h3 id="add-usage-query-patterns">Add usage query patterns</h3>
<p>Finally, to ensure that you can see sample data and queries performed over given assets, run the following usage workflow (<em>as always, adjust to your needs</em>):</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">prefect_openmetadata.flows</span> <span class="kn">import</span> <span class="n">ingest_metadata</span>

<span class="n">config</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">source:</span>
<span class="s2">  type: type: snowflake-usage</span>
<span class="s2">  serviceName: snowflake</span>
<span class="s2">  serviceConnection:</span>
<span class="s2">    config:</span>
<span class="s2">      type: Snowflake</span>
<span class="s2">      username: &quot;xxx&quot;</span>
<span class="s2">      password: &quot;xxx&quot;</span>
<span class="s2">      database: &quot;YOURDB&quot;</span>
<span class="s2">      warehouse: &quot;COMPUTE_WH&quot;</span>
<span class="s2">      account: &quot;YOUR_ACCOUNT.us-east-2.aws&quot;</span>
<span class="s2">  sourceConfig:</span>
<span class="s2">    config:</span>
<span class="s2">      type: DatabaseUsage</span>
<span class="s2">processor:</span>
<span class="s2">  type: query-parser</span>
<span class="s2">  config:</span>
<span class="s2">    filter: &#39;&#39;</span>
<span class="s2">workflowConfig:</span>
<span class="s2">  openMetadataServerConfig:</span>
<span class="s2">    hostPort: http://localhost:8585/api</span>
<span class="s2">    authProvider: no-auth</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">ingest_metadata</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</code></pre></div>
<p><strong>Congratulations</strong> on building your first metadata ingestion workflows with OpenMetadata and Prefect! Head over to the next section to see how you can run this flow on schedule. </p>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.a51614de.min.js"></script>
      
    
  </body>
</html>